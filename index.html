<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Çµ„Ç§„Éà</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Hiragino Sans', 'Yu Gothic', 'Meiryo', sans-serif;
            background-color: #f8f9fa;
            color: #333;
            line-height: 1.6;
        }

        /* Ë≥áÊñôÁÆ°ÁêÜÁî®„É≠„Ç∞„Ç§„É≥ÁîªÈù¢„ÅÆ„Çπ„Çø„Ç§„É´ */
        .login-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }

        .login-form {
            background: white;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            width: 90%;
            max-width: 400px;
        }

        .login-form h2 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 24px;
        }

        .login-form p {
            text-align: center;
            color: #6c757d;
            margin-bottom: 20px;
            font-size: 14px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #495057;
            font-weight: 500;
        }

        .form-group input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #dee2e6;
            border-radius: 6px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus {
            outline: none;
            border-color: #007bff;
        }

        .login-btn {
            width: 100%;
            padding: 12px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .login-btn:hover {
            background-color: #0056b3;
        }

        .login-error {
            color: #dc3545;
            text-align: center;
            margin-top: 15px;
            display: none;
        }

        /* „Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥„Çø„Éñ„ÅÆ„Çπ„Çø„Ç§„É´ */
        .admin-tabs {
            background: white;
            border-bottom: 2px solid #e9ecef;
            padding: 0 20px;
            display: block;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .tabs-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .tab-buttons {
            display: flex;
        }

        .tab-btn {
            padding: 15px 25px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 16px;
            color: #6c757d;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
        }

        .tab-btn.active {
            color: #007bff;
            border-bottom-color: #007bff;
            font-weight: 600;
        }

        .tab-btn:hover {
            color: #007bff;
        }

        .admin-controls {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .admin-status {
            color: #28a745;
            font-size: 14px;
            font-weight: 500;
        }

        .logout-btn {
            padding: 8px 16px;
            background-color: #dc3545;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s ease;
        }

        .logout-btn:hover {
            background-color: #c82333;
        }

        /* „É°„Ç§„É≥„Ç≥„É≥„ÉÜ„Éä */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
            background: white;
            min-height: calc(100vh - 80px);
        }

        /* Thank You„Éö„Éº„Ç∏„ÅÆ„Çπ„Çø„Ç§„É´ */
        .thank-you-page {
            max-width: 800px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .header h1 {
            font-size: 28px;
            color: #2c3e50;
            margin-bottom: 20px;
        }



        .description {
            text-align: center;
            margin-bottom: 40px;
            color: #6c757d;
            font-size: 16px;
        }

        .materials-section {
            margin-bottom: 40px;
        }

        .materials-title {
            font-size: 18px;
            margin-bottom: 20px;
            color: #2c3e50;
            text-align: center;
        }

        .select-all {
            text-align: center;
            margin-bottom: 20px;
        }

        .select-all label {
            display: inline-flex;
            align-items: center;
            cursor: pointer;
            font-weight: 500;
            color: #495057;
        }

        .select-all input[type="checkbox"] {
            margin-right: 8px;
            transform: scale(1.2);
        }

        .materials-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-bottom: 30px;
        }

        .material-item {
            text-align: center;
            transition: transform 0.2s ease;
        }

        .material-item:hover {
            transform: translateY(-2px);
        }

        .material-checkbox {
            margin-bottom: 10px;
        }

        .material-checkbox input[type="checkbox"] {
            margin-right: 8px;
            transform: scale(1.1);
        }

        .material-checkbox label {
            cursor: pointer;
            font-weight: 500;
            color: #495057;
        }

        .material-preview {
            width: 100%;
            height: 120px;
            background-color: #dee2e6;
            margin: 0 auto;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #6c757d;
            font-size: 12px;
            border: 2px solid transparent;
            transition: border-color 0.2s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .material-preview.selected {
            border-color: #28a745;
            box-shadow: 0 0 0 2px rgba(40, 167, 69, 0.3);
            transform: scale(1.05);
        }

        .material-preview img {
            max-width: 100%;
            max-height: 100%;
            border-radius: 6px;
            object-fit: contain;
        }

        .download-section {
            text-align: center;
        }

        .download-btn {
            background-color: #28a745;
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 16px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(40, 167, 69, 0.3);
        }

        .download-btn:hover {
            background-color: #218838;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(40, 167, 69, 0.4);
        }

        .download-btn:disabled {
            background-color: #6c757d;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .loading {
            display: none;
            margin-top: 20px;
            color: #6c757d;
        }

        .message {
            margin-top: 20px;
            padding: 15px;
            border-radius: 8px;
            display: none;
        }

        .message.success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .message.error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .message.info {
            background-color: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        /* ÁÆ°ÁêÜÁîªÈù¢„ÅÆ„Çπ„Çø„Ç§„É´ */
        .admin-page {
            display: none;
        }

        .admin-materials-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .material-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 15px rgba(0,0,0,0.1);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .material-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
        }

        .material-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e9ecef;
        }

        .material-title {
            font-size: 18px;
            font-weight: 600;
            color: #2c3e50;
        }

        .material-status {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
        }

        .status-uploaded {
            background-color: #d4edda;
            color: #155724;
        }

        .status-empty {
            background-color: #f8d7da;
            color: #721c24;
        }

        .preview-section {
            margin-bottom: 20px;
        }

        .preview-label {
            font-size: 14px;
            color: #495057;
            margin-bottom: 10px;
            font-weight: 500;
        }

        .admin-preview-area {
            width: 100%;
            height: 200px;
            border: 2px dashed #dee2e6;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #f8f9fa;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .admin-preview-area:hover {
            border-color: #007bff;
            background-color: #e3f2fd;
        }

        .admin-preview-area.dragover {
            border-color: #28a745;
            background-color: #d4edda;
        }

        .preview-placeholder {
            text-align: center;
            color: #6c757d;
            font-size: 14px;
        }

        .preview-image {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            border-radius: 6px;
        }

        .file-input-section {
            margin-bottom: 15px;
        }

        .file-input-wrapper {
            position: relative;
            display: inline-block;
            width: 100%;
        }

        .file-input {
            display: none;
        }

        .file-input-button {
            display: inline-block;
            width: 100%;
            padding: 12px 20px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            text-align: center;
            transition: background-color 0.3s ease;
        }

        .file-input-button:hover {
            background-color: #0056b3;
        }

        .file-input-button.success {
            background-color: #28a745;
        }

        .file-input-button.success:hover {
            background-color: #1e7e34;
        }

        .material-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .file-name {
            font-size: 12px;
            color: #6c757d;
            max-width: 60%;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .file-size {
            font-size: 12px;
            color: #28a745;
            font-weight: 500;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
        }

        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .btn-danger {
            background-color: #dc3545;
            color: white;
        }

        .btn-danger:hover {
            background-color: #c82333;
        }

        .btn-info {
            background-color: #17a2b8;
            color: white;
        }

        .btn-info:hover {
            background-color: #138496;
        }

        .global-actions {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .global-actions h3 {
            color: #2c3e50;
            margin-bottom: 15px;
        }

        .global-buttons {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .btn-global {
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background-color: #007bff;
            color: white;
        }

        .btn-primary:hover {
            background-color: #0056b3;
        }

        .btn-success {
            background-color: #28a745;
            color: white;
        }

        .btn-success:hover {
            background-color: #1e7e34;
        }

        .btn-warning {
            background-color: #ffc107;
            color: #212529;
        }

        .btn-warning:hover {
            background-color: #e0a800;
        }

        .statistics {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }

        .stat-item {
            text-align: center;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 8px;
        }

        .stat-number {
            font-size: 24px;
            font-weight: 600;
            color: #007bff;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 12px;
            color: #6c757d;
        }

        .admin-access-link {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 10px 15px;
            background-color: rgba(0, 123, 255, 0.9);
            color: white;
            text-decoration: none;
            border-radius: 25px;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(0, 123, 255, 0.3);
        }

        .admin-access-link:hover {
            background-color: rgba(0, 123, 255, 1);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 123, 255, 0.4);
        }

        @media (max-width: 768px) {
            .materials-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
            }
            
            .material-preview {
                height: 100px;
            }
        }
        
        @media (max-width: 480px) {
            .materials-grid {
                grid-template-columns: 1fr;
            }
            
            .material-preview {
                height: 140px;
            }
        }

            .admin-materials-grid {
                grid-template-columns: 1fr;
            }
            
            .global-buttons {
                flex-direction: column;
            }
            
            .btn-global {
                width: 100%;
            }

            .tabs-container {
                flex-direction: column;
                gap: 10px;
            }

            .admin-controls {
                margin-top: 10px;
            }
        }
    </style>
</head>
<body>
    <!-- Ë≥áÊñôÁÆ°ÁêÜÁî®„É≠„Ç∞„Ç§„É≥ÁîªÈù¢ -->
    <div class="login-overlay" id="adminLoginOverlay" style="display: none;">
        <div class="login-form">
            <h2>Ë≥áÊñôÁÆ°ÁêÜ - Ë™çË®º</h2>
            <p>Ë≥áÊñôÁÆ°ÁêÜ„Å´„Ç¢„ÇØ„Çª„Çπ„Åô„Çã„Å´„ÅØ„Éë„Çπ„ÉØ„Éº„Éâ„ÅåÂøÖË¶Å„Åß„Åô</p>
            <form id="adminLoginForm">
                <div class="form-group">
                    <label for="adminPassword">„Éë„Çπ„ÉØ„Éº„Éâ</label>
                    <input type="password" id="adminPassword" placeholder="„Éë„Çπ„ÉØ„Éº„Éâ„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ" required>
                </div>
                <div style="display: flex; gap: 10px;">
                    <button type="button" class="login-btn" style="background-color: #6c757d; flex: 1;" onclick="cancelAdminLogin()">„Ç≠„É£„É≥„Çª„É´</button>
                    <button type="submit" class="login-btn" style="flex: 1;">„É≠„Ç∞„Ç§„É≥</button>
                </div>
                <div class="login-error" id="adminLoginError">
                    „Éë„Çπ„ÉØ„Éº„Éâ„ÅåÈñìÈÅï„Å£„Å¶„ÅÑ„Åæ„Åô
                </div>
            </form>
        </div>
    </div>

    <!-- „Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥„Çø„Éñ -->
    <div class="admin-tabs" id="adminTabs">
        <div class="tabs-container">
            <div class="tab-buttons">
                <button class="tab-btn active" data-tab="thank-you">„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Çµ„Ç§„Éà</button>
                <button class="tab-btn" data-tab="admin">Ë≥áÊñôÁÆ°ÁêÜ</button>
            </div>
            <div class="admin-controls" id="adminControls" style="display: none;">
                <span class="admin-status">ÁÆ°ÁêÜËÄÖ„É¢„Éº„Éâ</span>
                <button class="logout-btn" onclick="logout()">‰∏ÄËà¨„É¢„Éº„Éâ</button>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- Thank You„Éö„Éº„Ç∏ -->
        <div id="thankYouPage" class="thank-you-page">
            <div class="header">
                <h1>„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Çµ„Ç§„Éà</h1>
            </div>



            <div class="description">

                Ë©≥Á¥∞„Å™PDFË≥áÊñô„Çí„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Åó„Å¶„ÅîÁ¢∫Ë™ç„ÅÑ„Åü„Å†„Åë„Åæ„Åô„ÄÇ<br>
                <small style="color: #999; font-size: 14px;">ÔºäPDFË≥áÊñô„ÅÆ„Åø„Åå„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Åï„Çå„Åæ„Åô„ÄÇ„Ç¢„Ç§„Ç≠„É£„ÉÉ„ÉÅÁîªÂÉè„ÅØ„Éó„É¨„Éì„É•„ÉºÁî®„Åß„Åô„ÄÇ</small>
            </div>

            <div class="materials-section">
                <div class="materials-title">„Åô„Åπ„Å¶„ÅÆË≥áÊñô‰∏ÄÊã¨„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Åô„Çã</div>
                
                <div class="select-all">
                    <label>
                        <input type="checkbox" id="selectAll">
                        ÂÖ®„Å¶ÈÅ∏Êäû
                    </label>
                </div>

                <div class="materials-grid">
                    <div class="material-item">
                        <div class="material-checkbox">
                            <label>
                                <input type="checkbox" class="material-check" data-material="1">
                                Êñ∞ÂÖ•Á§æÂì°Á†î‰øÆ
                            </label>
                        </div>
                        <div class="material-preview" data-material="1">
                            <span>Êñ∞ÂÖ•Á§æÂì°Á†î‰øÆ<br>„Éó„É¨„Éì„É•„Éº</span>
                        </div>
                    </div>

                    <div class="material-item">
                        <div class="material-checkbox">
                            <label>
                                <input type="checkbox" class="material-check" data-material="2">
                                Âü∫Êú¨
                            </label>
                        </div>
                        <div class="material-preview" data-material="2">
                            <span>Âü∫Êú¨<br>„Éó„É¨„Éì„É•„Éº</span>
                        </div>
                    </div>

                    <div class="material-item">
                        <div class="material-checkbox">
                            <label>
                                <input type="checkbox" class="material-check" data-material="3">
                                ‰∏≠Á¥ö
                            </label>
                        </div>
                        <div class="material-preview" data-material="3">
                            <span>‰∏≠Á¥ö<br>„Éó„É¨„Éì„É•„Éº</span>
                        </div>
                    </div>

                    <div class="material-item">
                        <div class="material-checkbox">
                            <label>
                                <input type="checkbox" class="material-check" data-material="4">
                                ÂøúÁî®
                            </label>
                        </div>
                        <div class="material-preview" data-material="4">
                            <span>ÂøúÁî®<br>„Éó„É¨„Éì„É•„Éº</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="download-section">
                <button class="download-btn" id="downloadBtn" disabled>
                    Ë≥áÊñô„Çí„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Åô„Çã
                </button>
                <div class="loading" id="loading">
                    „ÉÄ„Ç¶„É≥„É≠„Éº„ÉâÊ∫ñÂÇô‰∏≠...
                </div>
                <div class="message" id="message"></div>
            </div>
        </div>

        <!-- ÁÆ°ÁêÜÁîªÈù¢ -->
        <div id="adminPage" class="admin-page">
            <div class="global-actions">
                <h3>‰∏ÄÊã¨Êìç‰Ωú</h3>
                <div class="global-buttons">
                    <button class="btn-global btn-success" onclick="saveAllChanges()">
                        ÂÖ®„Å¶„ÅÆÂ§âÊõ¥„Çí‰øùÂ≠ò
                    </button>
                    <button class="btn-global btn-warning" onclick="resetAllMaterials()">
                        ÂÖ®„Å¶„É™„Çª„ÉÉ„Éà
                    </button>
                </div>
            </div>

            <div class="admin-materials-grid" id="adminMaterialsGrid">
                <!-- ÂãïÁöÑ„Å´ÁîüÊàê„Åï„Çå„ÇãË≥áÊñô„Ç´„Éº„Éâ -->
            </div>

            <div class="statistics">
                <h3>Áµ±Ë®àÊÉÖÂ†±</h3>
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-number" id="uploadedCount">0</div>
                        <div class="stat-label">„Ç¢„ÉÉ„Éó„É≠„Éº„ÉâÊ∏à„Åø</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number" id="emptyCount">4</div>
                        <div class="stat-label">Êú™Ë®≠ÂÆö</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number" id="totalSize">0</div>
                        <div class="stat-label">ÂêàË®à„Çµ„Ç§„Ç∫ (KB)</div>
                    </div>
                </div>
            </div>

            <div class="message" id="adminMessage"></div>
        </div>
    </div>

    <!-- „É°„Ç§„É≥„Éö„Éº„Ç∏Âæ©Â∏∞„É™„É≥„ÇØÔºà‰∏ÄËà¨„É¢„Éº„ÉâÊôÇ„ÅÆÂæ©Â∏∞Áî®Ôºâ -->
    <div class="admin-access-link" id="adminAccessLink" onclick="returnToMainMode()">
        üìÑ „É°„Ç§„É≥„Éö„Éº„Ç∏
    </div>

    <script>
        // „Ç∑„Çπ„ÉÜ„É†Ë®≠ÂÆö
        const ADMIN_PASSWORD = 'yukarin102@gmail.com';
        const SESSION_KEY = 'adminSession';
        const MATERIALS_KEY = 'materialsData';

        // Ë≥áÊñô„Éá„Éº„Çø„ÅÆÂàùÊúüË®≠ÂÆöÔºàË§áÊï∞„Éï„Ç°„Ç§„É´ÂØæÂøúÔºâ
        let materialsData = {
            1: { name: 'Êñ∞ÂÖ•Á§æÂì°Á†î‰øÆ', files: [] }, // files: [{image, pdfData, fileName, fileSize, fileType, id}]
            2: { name: 'Âü∫Êú¨', files: [] },
            3: { name: '‰∏≠Á¥ö', files: [] },
            4: { name: 'ÂøúÁî®', files: [] }
        };

        // „Éï„Ç°„Ç§„É´ID„ÅÆ„Ç´„Ç¶„É≥„Çø„Éº
        let fileIdCounter = 1;

        // Ë™çË®ºÁä∂ÊÖã„ÅÆÁÆ°ÁêÜ
        let isAdminAuthenticated = false;
        let currentTab = 'thank-you';

        // „Éö„Éº„Ç∏Ë™≠„ÅøËæº„ÅøÊôÇ„ÅÆÂàùÊúüÂåñ
        document.addEventListener('DOMContentLoaded', function() {
            loadMaterialsData();
            // ÂàùÂõû„ÅØThank You„Éö„Éº„Ç∏„ÇíË°®Á§∫
            showMainMode();
            initializeThankYouPage();
            
            // ÂàùÊúüË°®Á§∫ÊôÇ„Å´„Ç¢„Ç§„Ç≠„É£„ÉÉ„ÉÅÁîªÂÉè„ÇíÂêåÊúü
            setTimeout(() => {
                updateMaterialPreviews();
                console.log('Initial eyecatch images synchronized on page load');
            }, 200);
            
            // Ë≥áÊñôÁÆ°ÁêÜ„É≠„Ç∞„Ç§„É≥„Éï„Ç©„Éº„É†„ÅÆÂá¶ÁêÜ
            document.getElementById('adminLoginForm').addEventListener('submit', function(e) {
                e.preventDefault();
                handleAdminLogin();
            });

            // „Çø„ÉñÂàá„ÇäÊõø„Åà„ÅÆÂá¶ÁêÜ
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    requestTabSwitch(this.dataset.tab);
                });
            });
        });

        // „É≠„Éº„Ç´„É´„Çπ„Éà„É¨„Éº„Ç∏„Åã„Çâ„Éá„Éº„Çø„ÇíË™≠„ÅøËæº„Åø
        function loadMaterialsData() {
            const savedData = localStorage.getItem(MATERIALS_KEY);
            if (savedData) {
                materialsData = JSON.parse(savedData);
            }
        }

        // „Éá„Éº„Çø„Çí„É≠„Éº„Ç´„É´„Çπ„Éà„É¨„Éº„Ç∏„Å´‰øùÂ≠ò
        function saveMaterialsData() {
            localStorage.setItem(MATERIALS_KEY, JSON.stringify(materialsData));
        }

        // ÁÆ°ÁêÜËÄÖ„Çª„ÉÉ„Ç∑„Éß„É≥„ÅÆÁ¢∫Ë™ç
        function checkAdminSession() {
            const session = localStorage.getItem(SESSION_KEY);
            if (session) {
                const sessionData = JSON.parse(session);
                const now = new Date().getTime();
                
                // 24ÊôÇÈñì„Åß„Çª„ÉÉ„Ç∑„Éß„É≥ÊúüÈôêÂàá„Çå
                if (now - sessionData.timestamp < 24 * 60 * 60 * 1000) {
                    isAdminAuthenticated = true;
                    return true;
                } else {
                    localStorage.removeItem(SESSION_KEY);
                }
            }
            return false;
        }

        // „Çø„ÉñÂàá„ÇäÊõø„Åà„É™„ÇØ„Ç®„Çπ„ÉàÂá¶ÁêÜ
        function requestTabSwitch(tabName) {
            if (tabName === 'admin') {
                // Ë≥áÊñôÁÆ°ÁêÜ„Çø„Éñ„ÅÆÂ†¥Âêà„ÅØË™çË®º„ÉÅ„Çß„ÉÉ„ÇØ
                if (!isAdminAuthenticated && !checkAdminSession()) {
                    showAdminLogin();
                    return;
                }
            }
            switchTab(tabName);
        }

        // Ë≥áÊñôÁÆ°ÁêÜ„É≠„Ç∞„Ç§„É≥ÁîªÈù¢Ë°®Á§∫
        function showAdminLogin() {
            document.getElementById('adminLoginOverlay').style.display = 'flex';
            document.getElementById('adminPassword').focus();
        }

        // Ë≥áÊñôÁÆ°ÁêÜ„É≠„Ç∞„Ç§„É≥Âá¶ÁêÜ
        function handleAdminLogin() {
            const password = document.getElementById('adminPassword').value;
            const errorElement = document.getElementById('adminLoginError');
            
            if (password === ADMIN_PASSWORD) {
                // „É≠„Ç∞„Ç§„É≥ÊàêÂäü
                isAdminAuthenticated = true;
                const sessionData = {
                    timestamp: new Date().getTime()
                };
                localStorage.setItem(SESSION_KEY, JSON.stringify(sessionData));
                
                document.getElementById('adminLoginOverlay').style.display = 'none';
                document.getElementById('adminPassword').value = '';
                errorElement.style.display = 'none';
                
                switchTab('admin');
            } else {
                // „É≠„Ç∞„Ç§„É≥Â§±Êïó
                errorElement.style.display = 'block';
                document.getElementById('adminPassword').focus();
                document.getElementById('adminPassword').select();
            }
        }

        // Ë≥áÊñôÁÆ°ÁêÜ„É≠„Ç∞„Ç§„É≥„Ç≠„É£„É≥„Çª„É´
        function cancelAdminLogin() {
            document.getElementById('adminLoginOverlay').style.display = 'none';
            document.getElementById('adminPassword').value = '';
            document.getElementById('adminLoginError').style.display = 'none';
            
            // Thank You„Çø„Éñ„Å´Êàª„Çã
            switchTab('thank-you');
        }

        // „É≠„Ç∞„Ç¢„Ç¶„Éà
        function logout() {
            if (confirm('‰∏ÄËà¨„É¶„Éº„Ç∂„Éº„É¢„Éº„Éâ„Å´Âàá„ÇäÊõø„Åà„Åæ„Åô„ÅãÔºü')) {
                isAdminAuthenticated = false;
                localStorage.removeItem(SESSION_KEY);
                showPublicMode();
            }
        }

        // ÂÖ¨Èñã„É¢„Éº„ÉâË°®Á§∫
        function showPublicMode() {
            document.getElementById('adminTabs').style.display = 'none';
            document.getElementById('adminAccessLink').style.display = 'block';
            document.getElementById('thankYouPage').style.display = 'block';
            document.getElementById('adminPage').style.display = 'none';
            document.getElementById('adminControls').style.display = 'none';
        }

        // „É°„Ç§„É≥„É¢„Éº„ÉâË°®Á§∫Ôºà„Çø„Éñ‰ªò„ÅçÔºâ
        function showMainMode() {
            document.getElementById('adminTabs').style.display = 'block';
            document.getElementById('adminAccessLink').style.display = 'none';
            initializeAdminPage();
            switchTab('thank-you'); // „Éá„Éï„Ç©„É´„Éà„ÅßThank You„Éö„Éº„Ç∏„ÇíË°®Á§∫
        }

        // „É°„Ç§„É≥„É¢„Éº„Éâ„Å´Âæ©Â∏∞
        function returnToMainMode() {
            showMainMode();
        }

        // „Çø„ÉñÂàá„ÇäÊõø„Åà
        function switchTab(tabName) {
            currentTab = tabName;
            
            // „Çø„Éñ„Éú„Çø„É≥„ÅÆÁä∂ÊÖãÊõ¥Êñ∞
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');

            // „Éö„Éº„Ç∏„ÅÆË°®Á§∫Âàá„ÇäÊõø„Åà
            if (tabName === 'thank-you') {
                document.getElementById('thankYouPage').style.display = 'block';
                document.getElementById('adminPage').style.display = 'none';
                document.getElementById('adminControls').style.display = 'none';
                
                // Thank You„Éö„Éº„Ç∏Ë°®Á§∫ÊôÇ„Å´„Ç¢„Ç§„Ç≠„É£„ÉÉ„ÉÅÁîªÂÉè„ÇíÂêåÊúü
                setTimeout(() => {
                    updateMaterialPreviews();
                    console.log('Thank You page eyecatch images synchronized on tab switch');
                }, 100);
            } else if (tabName === 'admin') {
                document.getElementById('thankYouPage').style.display = 'none';
                document.getElementById('adminPage').style.display = 'block';
                document.getElementById('adminControls').style.display = 'flex';
                updateAdminUI();
            }
        }

        // Thank You„Éö„Éº„Ç∏„ÅÆÂàùÊúüÂåñ
        function initializeThankYouPage() {
            const selectAllCheckbox = document.getElementById('selectAll');
            const materialCheckboxes = document.querySelectorAll('.material-check');
            const materialPreviews = document.querySelectorAll('.material-preview');
            const downloadBtn = document.getElementById('downloadBtn');

            // „Ç¢„Ç§„Ç≠„É£„ÉÉ„ÉÅÁîªÂÉè„ÅÆÂàùÊúüË°®Á§∫
            console.log('Initializing Thank You page with eyecatch images...');
            updateMaterialPreviews();

            // ÂÖ®ÈÅ∏Êäû„ÉÅ„Çß„ÉÉ„ÇØ„Éú„ÉÉ„ÇØ„Çπ„ÅÆÂá¶ÁêÜ
            selectAllCheckbox.addEventListener('change', function() {
                materialCheckboxes.forEach(checkbox => {
                    checkbox.checked = this.checked;
                    updatePreviewSelection(checkbox);
                });
                updateDownloadButton();
            });

            // ÂÄãÂà•„ÉÅ„Çß„ÉÉ„ÇØ„Éú„ÉÉ„ÇØ„Çπ„ÅÆÂá¶ÁêÜ
            materialCheckboxes.forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    updatePreviewSelection(this);
                    updateSelectAllCheckbox();
                    updateDownloadButton();
                });
            });

            // „Éó„É¨„Éì„É•„ÉºÁîªÂÉè„ÅÆ„ÇØ„É™„ÉÉ„ÇØÂá¶ÁêÜ
            materialPreviews.forEach(preview => {
                preview.addEventListener('click', function() {
                    const materialId = this.dataset.material;
                    const checkbox = document.querySelector(`input[data-material="${materialId}"]`);
                    checkbox.checked = !checkbox.checked;
                    updatePreviewSelection(checkbox);
                    updateSelectAllCheckbox();
                    updateDownloadButton();
                });
            });

            // „ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Éú„Çø„É≥„ÅÆÂá¶ÁêÜ
            downloadBtn.addEventListener('click', handleDownload);

            updateDownloadButton();
        }

        // PDF„Ç¢„Ç§„Ç≥„É≥SVG„ÅÆÁîüÊàê
        function createPDFIcon() {
            return `<svg width="60" height="60" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M7 2V13H20V4C20 2.9 19.1 2 18 2H7Z" fill="#FF6B6B"/>
                <path d="M4 7V20C4 21.1 4.9 22 6 22H18C19.1 22 20 21.1 20 20V13H7C5.34 13 4 11.66 4 10V7Z" fill="#E53E3E"/>
                <text x="12" y="18" font-family="Arial, sans-serif" font-size="6" fill="white" text-anchor="middle">PDF</text>
            </svg>`;
        }

        // Ë≥áÊñô„Éó„É¨„Éì„É•„Éº„ÅÆÊõ¥Êñ∞ÔºàThank You„Éö„Éº„Ç∏„ÅÆ„Ç¢„Ç§„Ç≠„É£„ÉÉ„ÉÅÁîªÂÉè„ÇíÊõ¥Êñ∞Ôºâ
        function updateMaterialPreviews() {
            console.log('Updating material previews...', materialsData);
            Object.keys(materialsData).forEach(id => {
                // Thank You„Éö„Éº„Ç∏„ÅÆË≥áÊñô„Éó„É¨„Éì„É•„ÉºË¶ÅÁ¥†„ÇíÂèñÂæó
                const preview = document.querySelector(`.material-preview[data-material="${id}"]`);
                const material = materialsData[id];
                
                if (preview) {
                    if (material.files && material.files.length > 0) {
                        const firstFile = material.files[0]; // ÊúÄÂàù„ÅÆ„Éï„Ç°„Ç§„É´„Çí„Ç¢„Ç§„Ç≠„É£„ÉÉ„ÉÅ„Å®„Åó„Å¶‰ΩøÁî®
                        const fileCount = material.files.length;
                        
                        if (firstFile.image) {
                            // „Ç¢„ÉÉ„Éó„É≠„Éº„Éâ„Åï„Çå„ÅüÁîªÂÉè„Çí„Ç¢„Ç§„Ç≠„É£„ÉÉ„ÉÅ„Å®„Åó„Å¶Ë°®Á§∫
                            preview.innerHTML = `
                                <div style="position: relative; width: 100%; height: 100%;">
                                    <img src="${firstFile.image}" alt="${material.name}" style="width: 100%; height: 100%; object-fit: cover; border-radius: 6px;">
                                    ${fileCount > 1 ? `<div style="position: absolute; top: 5px; right: 5px; background: rgba(0,0,0,0.7); color: white; padding: 2px 6px; border-radius: 10px; font-size: 10px; font-weight: 600;">+${fileCount - 1}</div>` : ''}
                                </div>`;
                            preview.style.backgroundColor = '#ffffff';
                            console.log(`Updated Thank You page preview for ${material.name} with ${fileCount} files`);
                        } else if (firstFile.pdfData && firstFile.fileType === 'pdf') {
                            // PDF„Éï„Ç°„Ç§„É´„ÅÆÂ†¥Âêà„ÅØPDF„Ç¢„Ç§„Ç≥„É≥„ÇíË°®Á§∫
                            preview.innerHTML = `
                                <div style="position: relative; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100%; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 6px; color: white;">
                                    ${createPDFIcon()}
                                    <div style="margin-top: 5px; font-size: 11px; font-weight: 600; text-align: center;">${material.name}</div>
                                    <div style="font-size: 9px; opacity: 0.8;">${(firstFile.fileSize / 1024 / 1024).toFixed(1)}MB</div>
                                    ${fileCount > 1 ? `<div style="position: absolute; top: 5px; right: 5px; background: rgba(255,255,255,0.3); color: white; padding: 2px 6px; border-radius: 10px; font-size: 10px; font-weight: 600;">+${fileCount - 1}</div>` : ''}
                                </div>`;
                            preview.style.backgroundColor = '#ffffff';
                            console.log(`Updated Thank You page preview for ${material.name} with ${fileCount} PDF files`);
                        }
                    } else {
                        // „Éï„Ç°„Ç§„É´„Åå„Å™„ÅÑÂ†¥Âêà„ÅØ„Éá„Éï„Ç©„É´„ÉàË°®Á§∫
                        preview.innerHTML = `<span>${material.name}<br>„Éó„É¨„Éì„É•„Éº</span>`;
                        preview.style.backgroundColor = '#dee2e6';
                        console.log(`Updated Thank You page preview for ${material.name} without files`);
                    }
                } else {
                    console.warn(`Thank You page preview element not found for material ${id}`);
                }
            });
            
            // ÈÅ∏ÊäûÁä∂ÊÖã„ÇÇÂÜçÈÅ©Áî®
            const materialCheckboxes = document.querySelectorAll('.material-check');
            materialCheckboxes.forEach(checkbox => {
                if (checkbox.checked) {
                    updatePreviewSelection(checkbox);
                }
            });
        }

        // „Éó„É¨„Éì„É•„Éº„ÅÆÈÅ∏ÊäûÁä∂ÊÖã„ÇíÊõ¥Êñ∞Ôºà„Ç¢„Ç§„Ç≠„É£„ÉÉ„ÉÅÁîªÂÉè„ÅÆÈÅ∏ÊäûÁä∂ÊÖãÔºâ
        function updatePreviewSelection(checkbox) {
            const materialId = checkbox.dataset.material;
            const preview = document.querySelector(`.material-preview[data-material="${materialId}"]`);
            
            if (preview) {
                if (checkbox.checked) {
                    preview.classList.add('selected');
                    console.log(`Selected eyecatch for ${materialsData[materialId].name}`);
                } else {
                    preview.classList.remove('selected');
                    console.log(`Deselected eyecatch for ${materialsData[materialId].name}`);
                }
            }
        }

        // ÂÖ®ÈÅ∏Êäû„ÉÅ„Çß„ÉÉ„ÇØ„Éú„ÉÉ„ÇØ„Çπ„ÅÆÁä∂ÊÖã„ÇíÊõ¥Êñ∞
        function updateSelectAllCheckbox() {
            const materialCheckboxes = document.querySelectorAll('.material-check');
            const selectAllCheckbox = document.getElementById('selectAll');
            const checkedCount = document.querySelectorAll('.material-check:checked').length;
            const totalCount = materialCheckboxes.length;
            
            if (checkedCount === 0) {
                selectAllCheckbox.indeterminate = false;
                selectAllCheckbox.checked = false;
            } else if (checkedCount === totalCount) {
                selectAllCheckbox.indeterminate = false;
                selectAllCheckbox.checked = true;
            } else {
                selectAllCheckbox.indeterminate = true;
            }
        }

        // „ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Éú„Çø„É≥„ÅÆÁä∂ÊÖã„ÇíÊõ¥Êñ∞
        function updateDownloadButton() {
            const checkedCount = document.querySelectorAll('.material-check:checked').length;
            document.getElementById('downloadBtn').disabled = checkedCount === 0;
        }

        // „ÉÄ„Ç¶„É≥„É≠„Éº„ÉâÂá¶ÁêÜ
        function handleDownload() {
            const selectedMaterials = [];
            const materialCheckboxes = document.querySelectorAll('.material-check');
            
            materialCheckboxes.forEach(checkbox => {
                if (checkbox.checked) {
                    const materialId = checkbox.dataset.material;
                    selectedMaterials.push(materialsData[materialId]);
                }
            });

            if (selectedMaterials.length === 0) {
                showMessage('„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Åô„ÇãË≥áÊñô„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ', 'error');
                return;
            }

            // „ÉÄ„Ç¶„É≥„É≠„Éº„ÉâÂá¶ÁêÜ„ÅÆ„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥
            const downloadBtn = document.getElementById('downloadBtn');
            const loading = document.getElementById('loading');
            
            downloadBtn.disabled = true;
            loading.style.display = 'block';
            document.getElementById('message').style.display = 'none';

            setTimeout(() => {
                downloadFiles(selectedMaterials);
                
                loading.style.display = 'none';
                downloadBtn.disabled = false;
                showMessage(`${selectedMaterials.length}‰ª∂„ÅÆË≥áÊñô„Çí„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Åó„Åæ„Åó„Åü„ÄÇ`, 'success');
            
            // „ÉÄ„Ç¶„É≥„É≠„Éº„ÉâÂæå„ÇÇ„Ç¢„Ç§„Ç≠„É£„ÉÉ„ÉÅÁîªÂÉè„ÅÆÁä∂ÊÖã„ÇíÁ∂≠ÊåÅ
            setTimeout(() => {
                updateMaterialPreviews();
            }, 100);
            }, 2000);
        }

        // „Éï„Ç°„Ç§„É´„ÉÄ„Ç¶„É≥„É≠„Éº„ÉâÂá¶ÁêÜ
        function downloadFiles(selectedMaterials) {
            selectedMaterials.forEach(material => {
                if (material.files && material.files.length > 0) {
                    material.files.forEach((file, index) => {
                        // PDF„Éï„Ç°„Ç§„É´„ÅÆ„Åø„ÇíÂá¶ÁêÜ
                        if (file.pdfData && file.fileType === 'pdf') {
                            const fileName = material.files.length > 1 ? 
                                `${material.name}_${index + 1}_${file.fileName}` : 
                                file.fileName || `${material.name}.pdf`;
                            
                            // PDF„Éï„Ç°„Ç§„É´„ÅÆ„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ
                            setTimeout(() => downloadPDFFile(file.pdfData, fileName), index * 500);
                        }
                    });
                }
            });
        }

        // PDF„Éï„Ç°„Ç§„É´„ÅÆ„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ
        function downloadPDFFile(pdfData, fileName) {
            const link = document.createElement('a');
            link.href = pdfData;
            link.download = fileName;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // Âçò‰∏Ä„Éï„Ç°„Ç§„É´„ÅÆ„ÉÄ„Ç¶„É≥„É≠„Éº„ÉâÔºà„É¨„Ç¨„Ç∑„ÉºÔºâ
        function downloadFile(filename, displayName) {
            const link = document.createElement('a');
            link.href = `./files/${filename}`;
            link.download = displayName;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // ZIPÂΩ¢Âºè„Åß„ÅÆ„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ
        function downloadAsZip(selectedMaterials) {
            console.log('ZIP download:', selectedMaterials);
            // ÂÆüÈöõ„ÅÆÂÆüË£Ö„Åß„ÅØ„ÄÅ„Çµ„Éº„Éê„Éº„Çµ„Ç§„Éâ„ÅßZIP„Éï„Ç°„Ç§„É´„ÇíÁîüÊàê
        }

        // „É°„ÉÉ„Çª„Éº„Ç∏Ë°®Á§∫
        function showMessage(text, type, targetId = 'message') {
            const message = document.getElementById(targetId);
            message.textContent = text;
            message.className = `message ${type}`;
            message.style.display = 'block';
            
            setTimeout(() => {
                message.style.display = 'none';
            }, 5000);
        }

        // === ÁÆ°ÁêÜÁîªÈù¢„ÅÆÊ©üËÉΩ ===

        // ÁÆ°ÁêÜÁîªÈù¢„ÅÆÂàùÊúüÂåñ
        function initializeAdminPage() {
            updateAdminUI();
        }

        // ÁÆ°ÁêÜÁîªÈù¢UI„ÅÆÊõ¥Êñ∞
        function updateAdminUI() {
            const grid = document.getElementById('adminMaterialsGrid');
            grid.innerHTML = '';
            
            Object.keys(materialsData).forEach(id => {
                const cardHTML = createMaterialCard(id, materialsData[id]);
                grid.innerHTML += cardHTML;
            });
            
            updateStatistics();
        }

        // Ë≥áÊñô„Ç´„Éº„Éâ„ÇíÁîüÊàê
        function createMaterialCard(id, material) {
            const hasFiles = material.files && material.files.length > 0;
            const fileCount = hasFiles ? material.files.length : 0;
            const statusClass = hasFiles ? 'status-uploaded' : 'status-empty';
            const statusText = hasFiles ? `„Ç¢„ÉÉ„Éó„É≠„Éº„ÉâÊ∏à„Åø (${fileCount}‰ª∂)` : 'Êú™Ë®≠ÂÆö';
            const buttonClass = hasFiles ? 'success' : '';
            const buttonText = '„Éï„Ç°„Ç§„É´„ÇíËøΩÂä†';

            return `
                <div class="material-card">
                    <div class="material-header">
                        <div class="material-title">${material.name}</div>
                        <div class="material-status ${statusClass}">${statusText}</div>
                    </div>
                    
                    <div class="preview-section">
                        <div class="preview-label">„Éó„É¨„Éì„É•„Éº</div>
                        <div class="admin-preview-area" onclick="triggerFileInput(${id})" 
                             ondrop="handleDrop(event, ${id})" 
                             ondragover="handleDragOver(event)"
                             ondragenter="handleDragEnter(event)"
                             ondragleave="handleDragLeave(event)">
                            ${hasFiles ? 
                                generateFileListPreview(material.files) :
                                '<div class="preview-placeholder">„ÇØ„É™„ÉÉ„ÇØ„Åæ„Åü„ÅØ„Éâ„É©„ÉÉ„Ç∞&„Éâ„É≠„ÉÉ„Éó„Åß<br>ÁîªÂÉè„Åæ„Åü„ÅØPDF„Çí„Ç¢„ÉÉ„Éó„É≠„Éº„Éâ</div>'
                            }
                        </div>
                    </div>

                    <div class="file-input-section">
                        <div class="file-input-wrapper">
                            <input type="file" class="file-input" id="fileInput${id}" 
                                   accept="image/*,application/pdf,.pdf" onchange="handleFileSelect(event, ${id})">
                            <label for="fileInput${id}" class="file-input-button ${buttonClass}">
                                ${buttonText}
                            </label>
                        </div>
                    </div>

                    ${hasFiles ? `
                        <div class="files-list" style="max-height: 120px; overflow-y: auto; margin-bottom: 15px;">
                            ${material.files.map((file, index) => `
                                <div class="file-item" style="display: flex; justify-content: space-between; align-items: center; padding: 5px; border: 1px solid #e9ecef; border-radius: 4px; margin-bottom: 5px; background: #f8f9fa;">
                                    <div style="flex: 1; min-width: 0;">
                                        <div class="file-name" style="font-size: 12px; font-weight: 500; color: #495057; overflow: hidden; text-overflow: ellipsis;" title="${file.fileName}">${index + 1}. ${file.fileName}</div>
                                        <div class="file-size" style="font-size: 10px; color: #6c757d;">${file.fileType === 'pdf' ? (file.fileSize / 1024 / 1024).toFixed(1) + ' MB' : (file.fileSize / 1024).toFixed(1) + ' KB'}</div>
                                    </div>
                                    <div style="display: flex; gap: 5px;">
                                        <button class="btn" style="padding: 2px 6px; font-size: 10px; background-color: #17a2b8; color: white;" onclick="previewFile(${id}, ${file.id})">‚¶ø</button>
                                        <button class="btn" style="padding: 2px 6px; font-size: 10px; background-color: #dc3545; color: white;" onclick="removeFile(${id}, ${file.id})">√ó</button>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    ` : ''}

                    <div class="action-buttons">
                        ${hasFiles ? '<button class="btn btn-danger" onclick="removeAllFiles(' + id + ')">ÂÖ®„Å¶ÂâäÈô§</button>' : ''}
                        <button class="btn btn-info" onclick="previewMaterial(${id})">„Éó„É¨„Éì„É•„Éº</button>
                    </div>
                </div>
            `;
        }

        // „Éï„Ç°„Ç§„É´„É™„Çπ„Éà„Éó„É¨„Éì„É•„Éº„ÇíÁîüÊàê
        function generateFileListPreview(files) {
            if (!files || files.length === 0) return '';
            
            const firstFile = files[0];
            if (firstFile.image) {
                return `<img src="${firstFile.image}" alt="Preview" class="preview-image">`;
            } else if (firstFile.pdfData && firstFile.fileType === 'pdf') {
                return `<div style="display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100%; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 6px; color: white;">
                    ${createPDFIcon()}
                    <div style="margin-top: 8px; font-size: 12px; font-weight: 600;">${firstFile.fileName}</div>
                    <div style="font-size: 10px; opacity: 0.8;">${files.length}‰ª∂„ÅÆ„Éï„Ç°„Ç§„É´</div>
                </div>`;
            }
            return '';
        }

        // Áµ±Ë®àÊÉÖÂ†±„ÇíÊõ¥Êñ∞
        function updateStatistics() {
            let uploadedCount = 0;
            let totalFiles = 0;
            let totalSize = 0;
            
            Object.values(materialsData).forEach(material => {
                if (material.files && material.files.length > 0) {
                    uploadedCount++;
                    totalFiles += material.files.length;
                    material.files.forEach(file => {
                        totalSize += file.fileSize;
                    });
                }
            });
            
            document.getElementById('uploadedCount').textContent = `${uploadedCount}Ë≥áÊñô (${totalFiles}„Éï„Ç°„Ç§„É´)`;
            document.getElementById('emptyCount').textContent = 4 - uploadedCount;
            document.getElementById('totalSize').textContent = (totalSize / 1024 / 1024).toFixed(1);
        }

        // „Éï„Ç°„Ç§„É´ÂÖ•Âäõ„Çí„Éà„É™„Ç¨„Éº
        function triggerFileInput(id) {
            document.getElementById(`fileInput${id}`).click();
        }

        // „Éï„Ç°„Ç§„É´ÈÅ∏ÊäûÂá¶ÁêÜ
        function handleFileSelect(event, id) {
            const file = event.target.files[0];
            if (file) {
                if (file.type.startsWith('image/')) {
                    processImageFile(file, id);
                } else if (file.type === 'application/pdf' || file.name.toLowerCase().endsWith('.pdf')) {
                    processPDFFile(file, id);
                } else {
                    showMessage('ÁîªÂÉè„Éï„Ç°„Ç§„É´ÔºàJPG, PNGÁ≠âÔºâ„Åæ„Åü„ÅØPDF„Éï„Ç°„Ç§„É´„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ', 'error', 'adminMessage');
                }
            }
        }

        // „Éâ„É©„ÉÉ„Ç∞&„Éâ„É≠„ÉÉ„ÉóÂá¶ÁêÜ
        function handleDragOver(event) {
            event.preventDefault();
        }

        function handleDragEnter(event) {
            event.preventDefault();
            event.target.closest('.admin-preview-area').classList.add('dragover');
        }

        function handleDragLeave(event) {
            event.preventDefault();
            if (!event.target.closest('.admin-preview-area').contains(event.relatedTarget)) {
                event.target.closest('.admin-preview-area').classList.remove('dragover');
            }
        }

        function handleDrop(event, id) {
            event.preventDefault();
            event.target.closest('.admin-preview-area').classList.remove('dragover');
            
            const files = event.dataTransfer.files;
            if (files.length > 0) {
                const file = files[0];
                if (file.type.startsWith('image/')) {
                    processImageFile(file, id);
                } else if (file.type === 'application/pdf' || file.name.toLowerCase().endsWith('.pdf')) {
                    processPDFFile(file, id);
                } else {
                    showMessage('ÁîªÂÉè„Éï„Ç°„Ç§„É´ÔºàJPG, PNGÁ≠âÔºâ„Åæ„Åü„ÅØPDF„Éï„Ç°„Ç§„É´„Çí„Éâ„É≠„ÉÉ„Éó„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ', 'error', 'adminMessage');
                }
            }
        }

        // ÁîªÂÉè„Éï„Ç°„Ç§„É´„ÇíÂá¶ÁêÜ
        function processImageFile(file, materialId) {
            if (file.size > 5 * 1024 * 1024) {
                showMessage('„Éï„Ç°„Ç§„É´„Çµ„Ç§„Ç∫„ÅØ5MB‰ª•‰∏ã„Å´„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ', 'error', 'adminMessage');
                return;
            }

            const reader = new FileReader();
            reader.onload = function(e) {
                // A4Ê®™„Çµ„Ç§„Ç∫Ôºà16:9ÊØîÁéáÔºâ„Å´„É™„Çµ„Ç§„Ç∫
                resizeImageToA4Landscape(e.target.result, function(resizedImage) {
                    const fileData = {
                        id: fileIdCounter++,
                        image: resizedImage,
                        pdfData: null,
                        fileName: file.name,
                        fileSize: file.size,
                        fileType: 'image',
                        uploadDate: new Date().toISOString()
                    };
                    
                    materialsData[materialId].files.push(fileData);
                    
                    console.log(`Processed image for material ${materialId}:`, {
                        fileCount: materialsData[materialId].files.length,
                        fileName: file.name,
                        materialName: materialsData[materialId].name
                    });
                    
                    saveMaterialsData();
                    updateAdminUI();
                    
                    // Thank You„Éö„Éº„Ç∏„ÅÆ„Ç¢„Ç§„Ç≠„É£„ÉÉ„ÉÅÁîªÂÉè„ÇíÂç≥Â∫ß„Å´Êõ¥Êñ∞
                    setTimeout(() => {
                        updateMaterialPreviews();
                        console.log(`Thank You page eyecatch updated for ${materialsData[materialId].name}`);
                    }, 100);
                    
                    const fileCount = materialsData[materialId].files.length;
                    showMessage(`${materialsData[materialId].name}„Å´ÁîªÂÉè„ÅåËøΩÂä†„Åï„Çå„Åæ„Åó„Åü„ÄÇÔºàÁ∑èË®à${fileCount}‰ª∂ÔºâThank You„Éö„Éº„Ç∏„Å´„ÇÇÂèçÊò†„Åï„Çå„Åæ„Åó„Åü„ÄÇ`, 'success', 'adminMessage');
                });
            };
            reader.readAsDataURL(file);
        }

        // PDF„Éï„Ç°„Ç§„É´„ÇíÂá¶ÁêÜ
        function processPDFFile(file, materialId) {
            if (file.size > 10 * 1024 * 1024) { // PDF„ÅØ10MBÂà∂Èôê
                showMessage('PDF„Éï„Ç°„Ç§„É´„Çµ„Ç§„Ç∫„ÅØ10MB‰ª•‰∏ã„Å´„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ', 'error', 'adminMessage');
                return;
            }

            const reader = new FileReader();
            reader.onload = function(e) {
                const fileData = {
                    id: fileIdCounter++,
                    image: null,
                    pdfData: e.target.result,
                    fileName: file.name,
                    fileSize: file.size,
                    fileType: 'pdf',
                    uploadDate: new Date().toISOString()
                };
                
                materialsData[materialId].files.push(fileData);
                
                console.log(`Processed PDF for material ${materialId}:`, {
                    fileCount: materialsData[materialId].files.length,
                    fileName: file.name,
                    materialName: materialsData[materialId].name
                });
                
                saveMaterialsData();
                updateAdminUI();
                
                // Thank You„Éö„Éº„Ç∏„ÅÆ„Ç¢„Ç§„Ç≠„É£„ÉÉ„ÉÅ„Å´PDF„Ç¢„Ç§„Ç≥„É≥„ÇíË°®Á§∫
                setTimeout(() => {
                    updateMaterialPreviews();
                    console.log(`Thank You page eyecatch updated for ${materialsData[materialId].name} with PDF`);
                }, 100);
                
                const fileCount = materialsData[materialId].files.length;
                showMessage(`${materialsData[materialId].name}„Å´PDF„ÅåËøΩÂä†„Åï„Çå„Åæ„Åó„Åü„ÄÇÔºàÁ∑èË®à${fileCount}‰ª∂ÔºâThank You„Éö„Éº„Ç∏„Å´„ÇÇÂèçÊò†„Åï„Çå„Åæ„Åó„Åü„ÄÇ`, 'success', 'adminMessage');
            };
            reader.readAsDataURL(file);
        }

        // ÁîªÂÉè„ÇíA4Ê®™„Çµ„Ç§„Ç∫Ôºà16:9ÊØîÁéáÔºâ„Å´„É™„Çµ„Ç§„Ç∫
        function resizeImageToA4Landscape(imageSrc, callback) {
            const img = new Image();
            img.onload = function() {
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                
                // A4Ê®™„ÅÆÊØîÁéá (16:9„Å´Ëøë‰ºº)
                const targetWidth = 800;
                const targetHeight = 450;
                
                canvas.width = targetWidth;
                canvas.height = targetHeight;
                
                // ÁîªÂÉè„ÅÆ„Ç¢„Çπ„Éö„ÇØ„ÉàÊØî„Çí‰øùÊåÅ„Åó„Å™„Åå„Çâ„É™„Çµ„Ç§„Ç∫
                const sourceRatio = img.width / img.height;
                const targetRatio = targetWidth / targetHeight;
                
                let drawWidth, drawHeight, drawX, drawY;
                
                if (sourceRatio > targetRatio) {
                    // Ê®™Èï∑„ÅÆÁîªÂÉèÔºöÊ®™ÂπÖ„Å´Âêà„Çè„Åõ„Çã
                    drawWidth = targetWidth;
                    drawHeight = targetWidth / sourceRatio;
                    drawX = 0;
                    drawY = (targetHeight - drawHeight) / 2;
                } else {
                    // Á∏¶Èï∑„ÅÆÁîªÂÉèÔºöÁ∏¶ÂπÖ„Å´Âêà„Çè„Åõ„Çã
                    drawHeight = targetHeight;
                    drawWidth = targetHeight * sourceRatio;
                    drawX = (targetWidth - drawWidth) / 2;
                    drawY = 0;
                }
                
                // ËÉåÊôØ„ÇíÁôΩ„ÅßÂ°ó„Çä„Å§„Å∂„Åó
                ctx.fillStyle = '#ffffff';
                ctx.fillRect(0, 0, targetWidth, targetHeight);
                
                // ÁîªÂÉè„ÇíÊèèÁîª
                ctx.drawImage(img, drawX, drawY, drawWidth, drawHeight);
                
                // „É™„Çµ„Ç§„Ç∫„Åï„Çå„ÅüÁîªÂÉè„ÇíBase64„ÅßËøî„Åô
                callback(canvas.toDataURL('image/jpeg', 0.9));
            };
            img.src = imageSrc;
        }

        // ÁâπÂÆö„ÅÆ„Éï„Ç°„Ç§„É´„ÇíÂâäÈô§
        function removeFile(materialId, fileId) {
            const material = materialsData[materialId];
            const fileIndex = material.files.findIndex(file => file.id === fileId);
            
            if (fileIndex !== -1) {
                const fileName = material.files[fileIndex].fileName;
                if (confirm(`"${fileName}"„ÇíÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü`)) {
                    material.files.splice(fileIndex, 1);
                    
                    saveMaterialsData();
                    updateAdminUI();
                    
                    setTimeout(() => {
                        updateMaterialPreviews();
                        console.log(`File removed from ${material.name}`);
                    }, 100);
                    
                    const remainingCount = material.files.length;
                    showMessage(`„Éï„Ç°„Ç§„É´„ÅåÂâäÈô§„Åï„Çå„Åæ„Åó„Åü„ÄÇ${material.name}„Å´„ÅØ${remainingCount}‰ª∂„ÅÆ„Éï„Ç°„Ç§„É´„ÅåÊÆã„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇ`, 'success', 'adminMessage');
                }
            }
        }

        // Ë≥áÊñô„ÅÆÂÖ®„Éï„Ç°„Ç§„É´„ÇíÂâäÈô§
        function removeAllFiles(materialId) {
            const material = materialsData[materialId];
            const fileCount = material.files.length;
            
            if (confirm(`${material.name}„ÅÆÂÖ®„Å¶„ÅÆ„Éï„Ç°„Ç§„É´Ôºà${fileCount}‰ª∂Ôºâ„ÇíÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü`)) {
                material.files = [];
                
                saveMaterialsData();
                updateAdminUI();
                
                saveMaterialsData();
                updateAdminUI();
                
                // Thank You„Éö„Éº„Ç∏„ÅÆ„Ç¢„Ç§„Ç≠„É£„ÉÉ„ÉÅÁîªÂÉè„ÇíÂâäÈô§
                setTimeout(() => {
                    updateMaterialPreviews();
                    console.log(`All files removed from ${material.name}`);
                }, 100);
                
                showMessage(`${material.name}„ÅÆÂÖ®„Å¶„ÅÆ„Éï„Ç°„Ç§„É´„ÅåÂâäÈô§„Åï„Çå„Åæ„Åó„Åü„ÄÇThank You„Éö„Éº„Ç∏„Åã„Çâ„ÇÇÂâäÈô§„Åï„Çå„Åæ„Åó„Åü„ÄÇ`, 'success', 'adminMessage');
            }
        }

        // ÁâπÂÆö„ÅÆ„Éï„Ç°„Ç§„É´„Çí„Éó„É¨„Éì„É•„Éº
        function previewFile(materialId, fileId) {
            const material = materialsData[materialId];
            const file = material.files.find(f => f.id === fileId);
            
            if (!file) {
                showMessage('„Éï„Ç°„Ç§„É´„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì„ÄÇ', 'error', 'adminMessage');
                return;
            }
            
            if (file.image) {
                // ÁîªÂÉè„ÅÆÂ†¥Âêà
                const newWindow = window.open('', '_blank');
                newWindow.document.write(`
                    <html>
                        <head><title>${file.fileName} - „Éó„É¨„Éì„É•„Éº</title></head>
                        <body style="margin:0; display:flex; justify-content:center; align-items:center; min-height:100vh; background:#f0f0f0;">
                            <img src="${file.image}" style="max-width:100%; max-height:100%; object-fit:contain;">
                        </body>
                    </html>
                `);
            } else if (file.pdfData && file.fileType === 'pdf') {
                // PDF„ÅÆÂ†¥Âêà
                const newWindow = window.open('', '_blank');
                newWindow.location.href = file.pdfData;
            }
        }

        // Ë≥áÊñô„ÅÆÊúÄÂàù„ÅÆ„Éï„Ç°„Ç§„É´„Çí„Éó„É¨„Éì„É•„ÉºÔºàÊó¢Â≠ò„ÅÆÈñ¢Êï∞„Å®„ÅÆ‰∫íÊèõÊÄß„ÅÆ„Åü„ÇÅÔºâ
        function previewMaterial(materialId) {
            const material = materialsData[materialId];
            if (material.files && material.files.length > 0) {
                previewFile(materialId, material.files[0].id);
            } else {
                showMessage(`${material.name}„ÅÆ„Éï„Ç°„Ç§„É´„ÅåË®≠ÂÆö„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì„ÄÇ`, 'error', 'adminMessage');
            }
        }

        // ÂÖ®„Å¶„ÅÆÂ§âÊõ¥„Çí‰øùÂ≠ò
        function saveAllChanges() {
            saveMaterialsData();
            // Thank You„Éö„Éº„Ç∏„ÅÆ„Ç¢„Ç§„Ç≠„É£„ÉÉ„ÉÅ„ÇÇÂêåÊúü
            setTimeout(() => {
                updateMaterialPreviews();
                console.log('All changes saved and Thank You page eyecatch synchronized');
            }, 100);
            showMessage('ÂÖ®„Å¶„ÅÆÂ§âÊõ¥„Åå‰øùÂ≠ò„Åï„Çå„Åæ„Åó„Åü„ÄÇThank You„Éö„Éº„Ç∏„ÅÆ„Ç¢„Ç§„Ç≠„É£„ÉÉ„ÉÅ„ÇÇÊõ¥Êñ∞„Åï„Çå„Åæ„Åó„Åü„ÄÇ', 'success', 'adminMessage');
        }

        // ÂÖ®„Å¶„É™„Çª„ÉÉ„Éà
        function resetAllMaterials() {
            const totalFiles = Object.values(materialsData).reduce((sum, material) => sum + (material.files ? material.files.length : 0), 0);
            
            if (confirm(`ÂÖ®„Å¶„ÅÆË≥áÊñô„Éï„Ç°„Ç§„É´ÔºàÁ∑èË®à${totalFiles}‰ª∂Ôºâ„Çí„É™„Çª„ÉÉ„Éà„Åó„Åæ„Åô„ÅãÔºü„Åì„ÅÆÊìç‰Ωú„ÅØÂèñ„ÇäÊ∂à„Åõ„Åæ„Åõ„Çì„ÄÇ`)) {
                Object.keys(materialsData).forEach(id => {
                    materialsData[id].files = [];
                });
                
                saveMaterialsData();
                updateAdminUI();
                
                // Thank You„Éö„Éº„Ç∏„ÅÆÂÖ®„Ç¢„Ç§„Ç≠„É£„ÉÉ„ÉÅÁîªÂÉè„Çí„É™„Çª„ÉÉ„Éà
                setTimeout(() => {
                    updateMaterialPreviews();
                    console.log('All Thank You page eyecatch images reset');
                }, 100);
                
                showMessage('ÂÖ®„Å¶„ÅÆË≥áÊñô„Éï„Ç°„Ç§„É´„Åå„É™„Çª„ÉÉ„Éà„Åï„Çå„Åæ„Åó„Åü„ÄÇThank You„Éö„Éº„Ç∏„Åã„Çâ„ÇÇÂâäÈô§„Åï„Çå„Åæ„Åó„Åü„ÄÇ', 'info', 'adminMessage');
            }
